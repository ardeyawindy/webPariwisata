<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UAS | A6</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="mb-4 bg-light jumbotron"></div>
    <div class="container">
      <div class="card card-pesan shadow rounded">
        <div class="card-body">
          <h3 class="mb-4">Book Your Tickets!</h3>
          <div class="row g-3">
            <div class="input col-5">
              <div class="form-floating">
                <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                  <option selected>Select Destination</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
                <label for="floatingSelect">Destination</label>
              </div>
            </div>
            <div class="input col">
              <div class="form-floating">
                <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                  <option selected>Select Day</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
                <label for="floatingSelect">Day</label>
              </div>
            </div>
            <div class="input col">
              <div class="form-floating">
                <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                  <option selected>Select Hour</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
                <label for="floatingSelect">Hour</label>
              </div>
            </div>
            <div class="input col-auto">
              <a href="#all" class="btn btn-warning p-3">
                <i class="fas fa-search"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="popular-section">
        <div class="text-center">
          <h2><strong> POPULAR DESTINATION </strong></h2>
        </div>
        <div class="row g-3 mt-3" id="dataPop"></div>
      </div>
      <div class="destination-section" id="all">
        <h3><strong> All Destination </strong></h3>
        <div class="row g-5 mt-1 mb-5">
          <div class="filter sticky-top col-3">
            <div class="card">
              <div class="card-header"><i class="fas fa-sort-alpha-down" aria-hidden="true"></i> SORTINGS</div>
              <div class="card-body">
                <p class="card-text">Sort by</p>
                <select class="form-select mb-3" id="filter" aria-label="Default select example">
                  <option class="text-muted" selected="" value="nama">Name</option>
                  <option value="harga">Price</option>
                </select>
                <select class="form-select" id="sort" aria-label="Default select example">
                  <option value="ASC" selected>A - Z</option>
                  <option value="DESC">Z - A</option>
                </select>
              </div>
            </div>
            <div class="card mt-3">
              <div class="card-header"><i class="fas fa-filter" aria-hidden="true"></i> FILTERS</div>
              <div class="card-body">
                <p class="card-text">Search by Destination Name</p>
                <div class="input-group mb-3">
                  <input type="text" class="form-control" name="search" id="search" placeholder="Search title..." aria-label="Recipient's username" aria-describedby="button-addon2" />
                  <button class="btn btn-dark" type="button" id="button-addon2"><i class="fas fa-search" aria-hidden="true"></i></button>
                </div>
              </div>
            </div>
            <div class="card mt-3">
              <div class="card-header"><i class="fas fa-cog"></i> ADMIN</div>
              <div class="card-body">
                <div class="d-grid gap-3">
                  <a href="form.html" class="btn btn-outline-dark">Add New Destination</a>
                  <a href="formPop.html" class="btn btn-dark">Manage Destination</a>
                </div>
              </div>
            </div>
          </div>
          <div class="item col-9">
            <div class="row g-4" id="data"></div>
            <div class="row my-4 px-2">
              <button type="button" class="btn btn-dark" id="load">Load More</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Site footer -->
    <footer class="site-footer">
      <div class="container">
        <hr />
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">Copyright &copy; 2022 All Rights Reserved by 202410101038</p>
          </div>

          <div class="col-md-4 col-sm-6 col-xs-12">
            <ul class="social-icons">
              <li>
                <a class="facebook" href="#"><i class="fab fa-facebook-f"></i></a>
              </li>
              <li>
                <a class="twitter" href="#"><i class="fab fa-twitter"></i></a>
              </li>
              <li>
                <a class="dribbble" href="#"><i class="fab fa-dribbble"></i></a>
              </li>
              <li>
                <a class="linkedin" href="#"><i class="fab fa-linkedin"></i></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <!-- Modal -->
    <div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-body">
            <div class="d-flex">
              <img src="" alt="" class="modal-img" id="image" />
              <div class="isi align-self-center">
                <div class="d-flex justify-content-between">
                  <div class="">
                    <h2 id="title">Title</h2>
                    <div class="lokasi" id="lokasi">Lokasi</div>
                  </div>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="mt-3 deskripsi" id="deskripsi">Deskripsi</div>
                <div class="d-flex mt-3">
                  <div class="tag" id="harga"></div>
                  <div class="tag" id="buka"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script>
      var page = 0;
      $(document).ready(function () {
        $.get("popular.php?action=popular", function (response) {
          $.each(response, function (key, value) {
            $("#dataPop").append(
              "<div class='item col-3'><div class='card card-popular' data-id='" +
                value.id +
                "'>" +
                "<img src='" +
                value.image +
                "' class='card-img-top'/>" +
                "<div class='card-popular-body'>" +
                "<h5>" +
                value.nama +
                "</h5>" +
                "</div></div></div>"
            );
          });
        });
        $("#load")
          .click(function () {
            $(this).html("LOADING...").attr("disabled", "disabled");
            $.ajax({
              url: "data.php?action=read&begin=" + page,
              method: "GET",
              success: function (response) {
                $.each(response, function (key, value) {
                  $("#data").append(
                    "<div class='item-card col-4'>" +
                      "<div class='card card-popular' data-id='" +
                      value.id +
                      "'>" +
                      "<img src='" +
                      value.image +
                      "' class='card-img-top'/>" +
                      "<div class='price-tag'>" +
                      new Intl.NumberFormat("id-ID", { style: "currency", currency: "IDR", minimumFractionDigits: 0 }).format(value.harga) +
                      "</div>" +
                      "<div class='d-flex action-group'><a href='form.html?action=update&id=" +
                      value.id +
                      "'title='Ubah'><div class='tag-btn edit me-2'><i class='fas fa-edit'></i></div></a>" +
                      "<a href='data.php?action=delete&id=" +
                      value.id +
                      "'title='Hapus'><div class='tag-btn del'><i class='fas fa-trash'></i></div></a></div>" +
                      "<div class='card-popular-body'>" +
                      "<h5>" +
                      value.nama +
                      "</h5>" +
                      "<h6 class='card-text'>" +
                      value.lokasi +
                      "</h6>" +
                      "</div></div></div>"
                  );
                });
                page += 9;
                $("#load").html("Load More").removeAttr("disabled");
              },
            });
          })
          .trigger("click");

        $("body").on("click", ".card-popular", function () {
          var id = $(this).data("id");
          $.ajax({
            url: "data.php?action=detail&id=" + id,
            method: "GET",
            success: function (response) {
              $("#title").html(response.nama);
              $("#lokasi").html(response.lokasi);
              $("#deskripsi").html(response.deskripsi);
              $("#image").attr("src", response.image);
              $("#harga").html(new Intl.NumberFormat("id-ID", { style: "currency", currency: "IDR", minimumFractionDigits: 0 }).format(response.harga));
              $("#buka").html(response.jam_buka);
              $("#detailModal").modal("show");
            },
          });
        });

        $("body").on("click", ".delete", function () {
          var id = $(this).data("ide");
          $.ajax({
            url: "data.php?action=delete&id=" + id,
            method: "GET",
            success: function (response) {},
          });
        });

        $("#search").on("keyup", function () {
          $.ajax({
            type: "POST",
            url: "search.php",
            data: {
              search: $(this).val(),
            },
            cache: false,
            success: function (data) {
              $("#data").html(data);
              $("#load").hide();
            },
          });
        });

        $("#filter").on("change", function () {
          $.ajax({
            type: "POST",
            url: "sort.php",
            data: {
              sort: $("#sort").val(),
              filter: $("#filter").val(),
            },
            cache: false,
            success: function (data) {
              $("#data").html(data);
              $("#load").hide();
            },
          });
        });

        $("#sort").on("change", function () {
          $.ajax({
            type: "POST",
            url: "sort.php",
            data: {
              sort: $("#sort").val(),
              filter: $("#filter").val(),
            },
            cache: false,
            success: function (data) {
              $("#data").html(data);
              $("#load").hide();
            },
          });
        });
      });
    </script>
  </body>
</html>
